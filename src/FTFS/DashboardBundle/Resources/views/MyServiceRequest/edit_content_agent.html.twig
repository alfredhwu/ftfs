{% extends 'FTFSCrudBundle:Crud:edit_content.html.twig' %}

{% if '30_awaiting'==entity.status and entity.assignedTo==app.user.username %}

{% block crud_actions_icons %}
    <a href="javascript: submitform('noaccept')" class="btn btn-small" rel="tooltip" title="{{ (prefix~'_form_action_edit_update_noaccept_tooltip')|replace('_', '.')|trans({}, 'crud') }}" data-placement="bottom">
        <i class="icon-ok"></i>
    </a>
    <a href="javascript: submitform('accept')" class="btn btn-small" rel="tooltip" title="{{ (prefix~'_form_action_edit_update_accept_tooltip')|replace('_', '.')|replace('_', '.')|trans({}, 'crud') }}" data-placement="bottom">
        <i class="icon-share-alt"></i>
    </a>
    <a href="javascript: submitform('reject')" class="btn btn-small" rel="tooltip" title="{{ (prefix~'_form_action_edit_update_reject_tooltip')|replace('_', '.')|replace('_', '.')|trans({}, 'crud') }}" data-placement="bottom">
        <i class="icon-ban-circle"></i>
    </a>
    <a class="btn btn-small" href="{{ path(prefix~'_show', { 'id' : entity.id }) }}" rel="tooltip" title="{{ 'ftfs.crud.form.action.edit.cancel.tooltip'|trans({}, 'crud') }}" data-placement="bottom">
        <i class="icon-remove"></i>
    </a>
    <a class="btn btn-small" href="{{ path(prefix~'_index') }}" rel="tooltip" title="{{ 'ftfs.crud.form.action.edit.list.tooltip'|trans({}, 'crud') }}" data-placement="left">
        <i class="icon-list"></i>
    </a>
{% endblock %}

{% block crud_form %}
    <input type="hidden" name="update_mode" value="">
    {{ parent() }}
{% endblock %}


{% block crud_actions %}
    <div class="btn-toolbar">
        <div class="btn-group dropup">
            <a class="btn btn-primary" href="javascript: submitform('noaccept')">
                <i class="icon-ok icon-white"></i>
                {{ (prefix~'_form_action_edit_update_noaccept')|replace('_', '.')|trans({}, 'crud') }}
            </a>
            <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
                <span class="caret"></span>
            </a>
            <ul class="dropdown-menu">
                <li><a href="javascript: submitform('reject')">
                    <i class="icon-ban-circle"></i>
                    {{ (prefix~'_form_action_edit_update_reject')|replace('_', '.')|trans({}, 'crud') }}
                </a></li>
                <li><a href="javascript: submitform('accept')">
                    <i class="icon-share-alt"></i>
                    {{ (prefix~'_form_action_edit_update_accept')|replace('_', '.')|trans({}, 'crud') }}
                </a></li>
                <li><a href="javascript: submitform('noaccept')">
                    <i class="icon-ok"></i>
                    {{ (prefix~'_form_action_edit_update_noaccept')|replace('_', '.')|trans({}, 'crud') }}
                </a></li>
            </ul>
        </div>
        <div class="btn-group">
            <a href="{{ path(prefix~'_show', { 'id' : entity.id }) }}" class="btn">{{ 'ftfs.crud.form.action.edit.cancel'|trans({}, 'crud') }}</a>
        </div>
    </div>
    <script>
        function submitform(updatemode)
        {
            form = document.forms["{{ prefix~'_form' }}"];
            form.update_mode.value = updatemode;
            form.submit();
        }
    </script>
{% endblock %}

{% else %}
    {% block body %}
    <span> error ! normally you don't have access to this page. report this bug to your sys manager.</span>
    {% endblock %}
{% endif %}
